# The Definitive AOS v5.0 End-to-End Workflow Matrix

This matrix details the granular, sequential workflow for AOS v5.0. It incorporates the **Delegation of Authority Protocol**, allowing the process to operate in either a `HumanInLoop` or `FullAutonomy` mode.

| Step | Phase | Profile | Component(s) Involved | Task/Responsibility | Decision Maker | Output/Next Trigger |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **1.0** | **Phase 0: Triage & Scoping** | Both | **Human User**, L1 Adapter | **Task:** Initiate a project. **Responsibility:** User provides high-level strategic intent to the L1 Adapter. | **Human** | `ProjectInitiationRequest` object sent to L2 Core. |
| 1.1 | Phase 0: Triage & Scoping | Both | **L2 Core (`Request Router/Dispatcher`)** | **Task:** Initial request dispatch. **Responsibility:** Receives the request and performs a deterministic route to the `TriageOrchestratorPlugin`. | **Code** | Control is passed to the `TriageOrchestratorPlugin`. |
| 1.2 | Phase 0: Triage & Scoping | Both | **`TriageOrchestratorPlugin` (L2)**, `TriageAnalysisLLMPlugin` (L3) | **Task:** Analyze the request and draft a profile. **Responsibility:** Orchestrator invokes the L3 LLM plugin to parse the user's text and infer triage parameters (scale, profile, constraints). | **Code** | A pre-filled Triage Scorecard and profile recommendation. |
| 1.3 | Phase 0: Triage & Scoping | Both | **Human User** | **Task:** Confirm project setup and **choose Autonomy Mode**. **Responsibility:** User reviews the AI-generated, pre-filled form, confirms/corrects it, and selects the initial `delegation_policy` (`HumanInLoop` or `FullAutonomy`). | **Human** | Finalized profile and `delegation_policy` in the PDP. |
| 1.4 | Phase 0: Triage & Scoping | Both | **`TriageOrchestratorPlugin` (L2)**, PDP, KG, L2 Core (`EventBusPort`) | **Task:** Initialize the PDP and hand off. **Responsibility:** Creates the final PDP, writes the "Process Recipe" and `delegation_policy`, persists it to the KG, and publishes a `aos.pdp.triaged.v1` event. | **Code** | A triaged, immutable PDP; a `pdp.triaged` event is published. |
| 1.5 | Phase 0: Triage & Scoping | Both | **Meta-Orchestrator (L2)** | **Task:** Begin the 5D Journey. **Responsibility:** Consumes the `pdp.triaged` event, reads the first phase from the recipe, and routes the PDP to the corresponding `Phase Orchestrator`. | **Code** | Control is passed to the first `Phase Orchestrator`. |
| **2.0** | **Phase 1: DEFINE** | Standard | **DefinePhaseOrchestrator (L2)**, L3 Plugins (`WardleyMapPlugin`, `TOCAnalyzerPlugin`) | **Task:** Execute strategic analysis. **Responsibility:** Orchestrator invokes L3 plugins to generate the Wardley Map and constraint hypothesis. | **Code** | PDP is updated with `strategic_context` and `constraint_system`. |
| 2.1 | Phase 1: DEFINE | Standard | **`DefinePhaseOrchestrator` (L2)**, `StrategicAuditLLMPlugin` (L3) | **Task:** Perform automated audit. **Responsibility:** Before the human gate, the orchestrator invokes the LLM plugin to audit the generated strategy against the initial problem statement and flag inconsistencies. | **Code** | An audit report is attached to the PDP. |
| 2.2 | Phase 1: DEFINE | Standard | **Human User** OR **`AIDeciderPlugin` (L3)** | **Task:** Validate the strategic direction. **Responsibility:** Based on the `delegation_policy`, either a Human reviews the strategy (augmented by the LLM audit) or the `AIDeciderPlugin` makes the decision. The human is presented with options to delegate this step or all future steps. | **Human** or **Code (LLM)** | Acknowledgment/approval of the strategic analysis. |
| 2.3 | Phase 1: DEFINE | Standard | **DefinePhaseOrchestrator (L2)**, L2 Core (`EventBusPort`) | **Task:** Finalize the phase. **Responsibility:** Publishes a `aos.phase.completed.v1` event to the Event Bus. | **Code** | Event published on the bus. |
| **3.0** | **Phase 2: DIAGNOSE** | Standard | **Meta-Orchestrator (L2)**, `DiagnosePhaseOrchestrator (L2)` | **Task:** Route to the next phase. **Responsibility:** `Meta-Orchestrator` consumes the event and routes the PDP to the `DiagnosePhaseOrchestrator`. | **Code** | Control is passed to the `DiagnosePhaseOrchestrator`. |
| 3.1 | Phase 2: DIAGNOSE | Standard | **`DiagnosePhaseOrchestrator` (L2)**, `HistoricalContextLLMPlugin` (L3) | **Task:** Execute analysis and provide historical context. **Responsibility:** Orchestrator invokes plugins to classify the problem, run a Red Team challenge, and invokes the LLM plugin to query the KG for historical precedents. | **Code** | PDP is updated with diagnosis and a historical briefing. |
| 3.2 | Phase 2: DIAGNOSE | Standard | **Human User** OR **`AIDeciderPlugin` (L3)** | **Task:** Make the final complexity classification. **Responsibility:** Based on the `delegation_policy`, either a Human makes the sense-making judgment (augmented by the historical briefing) or the `AIDeciderPlugin` decides. | **Human** or **Code (LLM)** | Finalized complexity classification in the PDP. |
| 3.3 | Phase 2: DIAGNOSE | Standard | **DiagnosePhaseOrchestrator (L2)**, L2 Core (`EventBusPort`) | **Task:** Finalize the phase. **Responsibility:** Publishes the `aos.phase.completed.v1` event. | **Code** | Event published on the bus. |
| **4.0** | **Phase 3: DESIGN** | Standard | **Meta-Orchestrator (L2)**, `DesignPhaseOrchestrator (L2)` | **Task:** Route to the next phase. **Responsibility:** `Meta-Orchestrator` consumes the event and routes the PDP to the `DesignPhaseOrchestrator`. | **Code** | Control is passed to the `DesignPhaseOrchestrator`. |
| 4.1 | Phase 3: DESIGN | Standard | **`DesignPhaseOrchestrator` (L2)**, Suite of L3 LLM Assistant Plugins | **Task:** Generate and analyze solution options. **Responsibility:** Orchestrator invokes design plugins to create options, then invokes a suite of LLM assistants (`PreMortemLLMPlugin`, `HMAComplianceLLMPlugin`, `SecurityAuditLLMPlugin`) to analyze each option. | **Code** | A set of candidate architectures, each with a comprehensive analysis report. |
| 4.2 | Phase 3: DESIGN | Standard | **Human User** OR **`AIDeciderPlugin` (L3)** | **Task:** Select the final solution architecture. **Responsibility:** Based on the `delegation_policy`, either a Human makes the strategic trade-off decision (using the AI-generated analysis) or the `AIDeciderPlugin` makes the selection. | **Human** or **Code (LLM)** | The chosen `solution_architecture` is finalized in the PDP. |
| 4.3 | Phase 3: DESIGN | Standard | **DesignPhaseOrchestrator (L2)**, L2 Core (`EventBusPort`) | **Task:** Finalize the phase. **Responsibility:** Publishes the `aos.phase.completed.v1` event. | **Code** | Event published on the bus. |
| **5.0** | **Phase 4: DEVELOP** | Both | **Meta-Orchestrator (L2)**, `DevelopPhaseOrchestrator (L2)` | **Task:** Route to the next phase. **Responsibility:** `Meta-Orchestrator` consumes the event and routes the PDP to the `DevelopPhaseOrchestrator`. | **Code** | Control is passed to the `DevelopPhaseOrchestrator`. |
| 5.1 | Phase 4: DEVELOP | Both | **`DevelopPhaseOrchestrator` (L2)**, `DecompositionPlugin` (L3) | **Task:** Decompose the solution. **Responsibility:** Orchestrator invokes the `DecompositionPlugin`. The plugin now includes rule-based auto-refactoring to attempt to self-correct low coupling scores before escalating. | **Code** | A proposed decomposition plan and coupling analysis. |
| 5.2 | Phase 4: DEVELOP | Both | **Human User** OR **`AIDeciderPlugin` (L3)** **(Exception-based)** | **Task:** Review low-quality decomposition. **Responsibility:** *Only if the enhanced `DecompositionPlugin` cannot self-correct*, the `delegation_policy` is checked. Either a Human reviews the plan or the `AIDeciderPlugin` makes the decision to approve or retry. | **Human** or **Code (LLM)** | Approval to proceed with decomposition. |
| 5.3 | Phase 4: DEVELOP | Both | **DevelopPhaseOrchestrator (L2)**, L2 Core (`EventBusPort`) | **Task:** Create child work. **Responsibility:** Creates immutable child PDPs (for Standard) or work items (for Lite) and publishes relevant events. | **Code** | Child work created; `aos.phase.completed.v1` event published for the parent. |
| **6.0** | **Phase 5: DELIVER & LEARN** | Both | **Meta-Orchestrator (L2)**, `DeliverLearnOrchestrator (L2)` | **Task:** Route to the next phase. **Responsibility:** `Meta-Orchestrator` consumes the event and routes the PDP to the `DeliverLearnOrchestrator`. | **Code** | Control is passed to the `DeliverLearnOrchestrator`. |
| 6.1 | Phase 5: DELIVER & LEARN | Both | **`DeliverLearnOrchestrator` (L2)**, `CyberneticControllerPlugin` (L3) | **Task:** Execute and monitor the plan. **Responsibility:** Orchestrator manages the execution loop. The `CyberneticControllerPlugin` now includes automated recovery playbooks to handle minor deviations. | **Code** | Ongoing delivery of value; real-time telemetry stored in the PDP. |
| 6.2 | Phase 5: DELIVER & LEARN | Both | **Human User** OR **`AIDeciderPlugin` (L3)** **(Exception-based)** | **Task:** Decide on interventions. **Responsibility:** *Only if the automated recovery playbooks fail*, the `delegation_policy` is checked. Either a Human decides on the strategic response (aided by a "Decision Advisor" LLM) or the `AIDeciderPlugin` selects the best course of action. | **Human** or **Code (LLM)** | A strategic adjustment to the plan. |
| 6.3 | Phase 5: DELIVER & LEARN | Both | **`DeliverLearnOrchestrator` (L2)**, `RetrospectiveLLMPlugin` (L3) | **Task:** Draft the final project summary. **Responsibility:** When success criteria are met, the orchestrator invokes the LLM plugin to automatically generate a summary report from the PDP's data. | **Code** | A draft summary report is attached to the PDP. |
| 6.4 | Phase 5: DELIVER & LEARN | Both | **Human User** OR **`AIDeciderPlugin` (L3)** | **Task:** Confirm final project completion. **Responsibility:** Based on the `delegation_policy`, either a Human reviews the AI-generated summary and confirms the project met its strategic intent, or the `AIDeciderPlugin` provides the final sign-off. | **Human** or **Code (LLM)** | The PDP status is set to "Complete". |
| 6.5 | Phase 5: DELIVER & LEARN | Both | **DeliverLearnOrchestrator (L2)**, L2 Core (`EventBusPort`) | **Task:** Finalize the phase. **Responsibility:** Publishes the final `aos.phase.completed.v1` event. | **Code** | Event published on the bus. |
| **7.0** | **Final Resolution** | Both | **Meta-Orchestrator (L2)**, Knowledge Graph | **Task:** Archive the project. **Responsibility:** `Meta-Orchestrator` receives the final event, sees the recipe is empty, marks the PDP as resolved, and performs final archival into the Knowledge Graph. | **Code** | Project closed. Learnings and artifacts become part of the organizational memory in the KG. 
